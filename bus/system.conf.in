<!-- This configuration file controls the systemwide message bus.
     Add a system-local.conf and edit that rather than changing this 
     file directly. -->

<!-- Note that there are any number of ways you can hose yourself
     security-wise by screwing up this file; in particular, you
     probably don't want to listen on any more addresses, add any more
     auth mechanisms, run as a different user, etc. -->

<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-Bus Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>

  <!-- Our well-known bus type, do not change this -->
  <type>system</type>

  <!-- We use system service launching using a helper -->
  <standard_system_servicedirs/>

  <!-- Only allow authentication : dbus-cookie-sha1-based, socket-credentials-based ...  -->
  <auth>@DBUS_AUTH@</auth>

  <!-- Only listen on a local socket. (abstract=/path/to/socket 
       means use abstract namespace, don't really create filesystem 
       file; only Linux supports this. Use path=/whatever on other 
       systems.) -->
  <listen>@DBUS_SYSTEM_BUS_DEFAULT_ADDRESS@</listen>

  <policy context="default">
    <!-- All users can connect to system bus -->
    <allow user="*"/>
    <allow own="*"/>
    <allow send_type="method_call"/>
    <allow send_type="signal"/>
    <allow receive_type="signal"/>

    <!-- Signals and reply messages (method returns, errors) are allowed
         by default -->
    <allow send_type="signal"/>
    <allow send_requested_reply="true" send_type="method_return"/>
    <allow send_requested_reply="true" send_type="error"/>

    <!-- All messages may be received by default -->
    <allow receive_type="method_call"/>
    <allow receive_type="method_return"/>
    <allow receive_type="error"/>
    <allow receive_type="signal"/>

    <!-- Allow anyone to talk to the message bus -->
    <allow send_destination="org.freedesktop.DBus"/>
    <!-- But disallow some specific bus services -->
    <deny send_destination="org.freedesktop.DBus"
          send_interface="org.freedesktop.DBus"
          send_member="UpdateActivationEnvironment"/>
    <deny send_destination="org.freedesktop.DBus"
          send_interface="org.freedesktop.systemd1.Activator"/>
  </policy>

  <!-- Set limits to the same values than dbus defaults. -->
  <limit name="max_incoming_bytes">127000000</limit>
  <limit name="max_incoming_unix_fds">64</limit>
  <limit name="max_outgoing_bytes">127000000</limit>
  <limit name="max_outgoing_unix_fds">64</limit>
  <limit name="max_message_size">32000000</limit>
  <limit name="max_message_unix_fds">16</limit>
  <limit name="service_start_timeout">25000</limit>
  <limit name="auth_timeout">30000</limit>
  <limit name="pending_fd_timeout">150000</limit>
  <limit name="max_completed_connections">2048</limit>
  <limit name="max_incomplete_connections">64</limit>
  <limit name="max_connections_per_user">256</limit>
  <limit name="max_pending_service_starts">512</limit>
  <limit name="max_names_per_connection">512</limit>
  <limit name="max_match_rules_per_connection">512</limit>
  <limit name="max_replies_per_connection">128</limit>
</busconfig>
